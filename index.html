<!DOCTYPE html>
<html>
<head>
        <title>My Location</title>
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        <script src="https://telegram.org/js/telegram-web-app.js"></script>
        <style>
		html, body {
			height: 100%;
			margin: 0;
			padding: 0;
		}
		#map {
			height: 100%;
			width: 100%;
		}
		.info-window img {
			width: 200px;
			border-radius: 10px;
		}
	</style>
</head>
<body>
        <div id="map">Loading map...</div>

        <script>
		const tg = window.Telegram.WebApp;
		tg.expand();

		function initMap() {
			if (navigator.geolocation) {
				navigator.geolocation.getCurrentPosition(position => {
					userLocation = {
						lat: position.coords.latitude,
						lng: position.coords.longitude
					};

					const map = new google.maps.Map(document.getElementById("map"), {
						center: userLocation,
						zoom: 14
					});

					new google.maps.Marker({
						position: userLocation,
						map: map,
						title: "You are here",
						icon: "http://maps.google.com/mapfiles/ms/icons/blue-dot.png"
					});

					// Initialize directions services
					directionsService = new google.maps.DirectionsService();
					directionsRenderer = new google.maps.DirectionsRenderer({
						map: map,
						suppressMarkers: true
					});

					// POIs
					const pois = [
						{
							position: { lat: 40.1792, lng: 44.4991 },
							title: "Republic Square",
							image: "https://upload.wikimedia.org/wikipedia/commons/thumb/b/b6/Republic_Square_Yerevan_2022.jpg/800px-Republic_Square_Yerevan_2022.jpg",
							description: "Central square in Yerevan, famous for its fountains and architecture."
						},
						{
							position: { lat: 40.1858, lng: 44.5126 },
							title: "Cascade Complex",
							image: "https://upload.wikimedia.org/wikipedia/commons/thumb/8/88/Cascade_Yerevan_2022.jpg/800px-Cascade_Yerevan_2022.jpg",
							description: "Giant stairway and open-air museum connecting downtown Yerevan to the Monument neighborhood."
						}
					];

					// Add POIs and directions logic
					pois.forEach(poi => {
						const marker = new google.maps.Marker({
							position: poi.position,
							map: map,
							title: poi.title
						});

						const infoWindow = new google.maps.InfoWindow({
							content: `
								<div class="info-window">
									<h3>${poi.title}</h3>
									<img src="${poi.image}" alt="${poi.title}" />
									<p>${poi.description}</p>
									<p><strong>Click marker to show route</strong></p>
								</div>
							`
						});

						marker.addListener("click", () => {
							infoWindow.open(map, marker);
							showRouteTo(poi.position);
						});
					});

					// Route function
					function showRouteTo(destination) {
						const request = {
							origin: userLocation,
							destination: destination,
							travelMode: google.maps.TravelMode.WALKING // or DRIVING
						};

						directionsService.route(request, (result, status) => {
							if (status === "OK") {
								directionsRenderer.setDirections(result);
							} else {
								alert("Directions request failed: " + status);
							}
						});
					}
				}, error => {
					alert("Geolocation failed: " + error.message);
				});
			} else {
				alert("Geolocation is not supported by your browser.");
			}
		}
	</script>
        
        <!-- Google Maps API -->
        <script async defer
                src="https://maps.googleapis.com/maps/api/js?key=AIzaSyDgrqPPgd53x8AbJWpsgrDCWbnKvWtPRw4&callback=initMap">
        </script>
</body>
</html>

